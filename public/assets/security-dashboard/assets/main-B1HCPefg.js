import{j as e,r as d,a as y,R as u}from"./react-vendor-4yyAa-vC.js";import{f as j}from"./vendor-Bele6Zm2.js";import{E as b}from"./echarts-B1nNZuTz.js";const o=({label:s,value:l})=>e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-800 last:border-0 hover:bg-white/5 px-2",children:[e.jsx("span",{className:"text-gray-500 text-xs uppercase font-semibold tracking-wider",children:s}),e.jsx("span",{className:"text-gray-300 font-mono text-sm max-w-xs truncate text-right",title:String(l),children:typeof l=="object"?JSON.stringify(l):String(l)})]}),p=({title:s,children:l})=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-xs uppercase text-blue-500 font-bold mb-3 border-b border-blue-900/50 pb-1",children:s}),e.jsx("div",{className:"bg-gray-950 rounded border border-gray-800 p-2",children:l})]}),N=({data:s,onClose:l})=>{if(!s)return null;const a=typeof s.raw_data=="string"?JSON.parse(s.raw_data):s.raw_data;return e.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl shadow-2xl border border-gray-700 w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-gray-800 rounded-t-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-900/30 p-2 rounded-lg text-blue-400 text-xl",children:"ðŸ”"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Digital Forensic Report"}),e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-widest",children:s.device_hash})]})]}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-white hover:bg-gray-700 p-2 rounded-full transition",children:"âœ•"})]}),e.jsxs("div",{className:"p-6 overflow-y-auto custom-scrollbar flex-1 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs(p,{title:"Network Identity",children:[e.jsx(o,{label:"Public IP",value:s.ip_address}),e.jsx(o,{label:"Local IPs (WebRTC)",value:s.local_ips?.join(", ")||"N/A"}),e.jsx(o,{label:"User Agent",value:a.ua||a.userAgent||"Unknown"}),e.jsx(o,{label:"Timezone",value:s.timezone})]}),e.jsxs(p,{title:"Device Hardware",children:[e.jsx(o,{label:"Screen Resolution",value:s.screen_resolution}),e.jsx(o,{label:"CPU Cores",value:a.hardwareConcurrency||"N/A"}),e.jsx(o,{label:"Device Memory (RAM)",value:a.deviceMemory?`~${a.deviceMemory} GB`:"N/A"}),e.jsx(o,{label:"Platform",value:a.platform||"Unknown"})]})]}),e.jsxs("div",{children:[e.jsxs(p,{title:"Browser Capability",children:[e.jsx(o,{label:"Language",value:a.language||"N/A"}),e.jsx(o,{label:"Cookies Enabled",value:a.cookieEnabled?"Yes":"No"}),e.jsx(o,{label:"Do Not Track",value:a.doNotTrack||"Unspecified"}),e.jsx(o,{label:"Touch Support",value:a.touchSupport?"Yes":"No"})]}),e.jsxs(p,{title:"Graphics (Entropy High)",children:[e.jsx(o,{label:"Renderer",value:a.webgl?.renderer||"N/A"}),e.jsx(o,{label:"Vendor",value:a.webgl?.vendor||"N/A"}),e.jsx(o,{label:"Canvas Hash",value:s.canvas_hash||a.canvas_hash||"N/A"})]})]}),e.jsx("div",{className:"col-span-1 md:col-span-2",children:e.jsx(p,{title:"Full JSON Payload",children:e.jsx("pre",{className:"text-[10px] text-green-400 font-mono bg-black p-4 rounded overflow-x-auto max-h-40",children:JSON.stringify(a,null,2)})})})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-800/50 flex justify-between items-center rounded-b-xl",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Generated: ",s.created_at]}),e.jsx("button",{onClick:l,className:"px-6 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded font-medium shadow-lg shadow-blue-900/20 transition",children:"Close Report"})]})]})})},f=()=>{const[s,l]=d.useState([]),[a,n]=d.useState(!0),[c,r]=d.useState(null),[i,x]=d.useState(null);return d.useEffect(()=>{fetch("/api/security/forensics").then(async t=>{if(!t.ok){const h=await t.text();throw new Error(`API Error ${t.status}: ${h}`)}return t.json()}).then(t=>{Array.isArray(t)?l(t):(console.error("Forensics API returned non-array:",t),x("Invalid Data Format: "+JSON.stringify(t)),l([])),n(!1)}).catch(t=>{console.error("Failed to load forensics",t),x(t.message),n(!1)})},[]),a?e.jsx("div",{className:"p-4 text-white",children:"Loading Forensics Data..."}):e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg border border-gray-700 mt-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400",children:"ðŸ“±"})," Device Level Analytics (Forensics)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-200 uppercase bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Time"}),e.jsx("th",{className:"px-6 py-3",children:"Public IP"}),e.jsx("th",{className:"px-6 py-3",children:"Local IPs (WebRTC Leak)"}),e.jsx("th",{className:"px-6 py-3",children:"Device Hash"}),e.jsx("th",{className:"px-6 py-3",children:"Screen"}),e.jsx("th",{className:"px-6 py-3",children:"Actions"})]})}),e.jsxs("tbody",{children:[s?.map(t=>e.jsxs("tr",{className:"bg-gray-800 border-b border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-6 py-4",children:j(new Date(t.created_at),"MMM dd HH:mm:ss")}),e.jsx("td",{className:"px-6 py-4 font-mono text-blue-400",children:t.ip_address}),e.jsx("td",{className:"px-6 py-4 font-mono text-yellow-400",children:t.local_ips&&t.local_ips.length>0?t.local_ips.join(", "):e.jsx("span",{className:"text-gray-600",children:"No Leak"})}),e.jsxs("td",{className:"px-6 py-4 font-mono text-xs",children:[t.device_hash.substring(0,12),"..."]}),e.jsx("td",{className:"px-6 py-4",children:t.screen_resolution}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>r(t),className:"text-xs bg-blue-600 hover:bg-blue-500 text-white px-2 py-1 rounded",children:"View Details"})})]},t.id)),i?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-4 text-center text-red-500 font-bold",children:["Error loading data: ",i]})}):(!s||s.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center",children:"No forensics data captured yet."})})]})]})}),c&&e.jsx(N,{data:c,onClose:()=>r(null)})]})};function v(){const[s,l]=d.useState([]),[a,n]=d.useState(!0),[c,r]=d.useState(null),i=()=>{fetch("/api/security/blocked-ips").then(t=>{if(!t.ok)throw new Error(`HTTP ${t.status}`);return t.json()}).then(t=>{l(Array.isArray(t)?t:[]),n(!1),r(null)}).catch(t=>{console.error("Failed to load blocked IPs",t),l([]),n(!1),r(t.message||"Network error")})};d.useEffect(()=>{i();const t=setInterval(i,1e4);return()=>clearInterval(t)},[]);const x=async(t,h)=>{if(confirm(`Are you sure you want to unblock ${h}?`))try{const m=await fetch(`/api/security/blocked-ips/${t}`,{method:"DELETE"}),g=await m.json();m.ok?(alert(`âœ… ${g.message}`),i()):alert(`âŒ Failed to unblock IP: ${g.message}`)}catch(m){console.error("Error unblocking IP:",m),alert("âŒ Failed to unblock IP")}};return a&&!c?e.jsx("div",{className:"text-white p-4",children:"Loading blocked IPs..."}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-4",children:"ðŸš« Blocked IP Addresses"}),c&&e.jsxs("div",{className:"bg-yellow-900/50 border border-yellow-700 text-yellow-200 px-4 py-3 rounded mb-4",children:[e.jsx("p",{className:"font-bold",children:"âš ï¸ Unable to load blocked IPs"}),e.jsxs("p",{className:"text-sm",children:["Error: ",c]})]}),s.length===0&&!c?e.jsx("p",{className:"text-gray-400",children:"No IPs are currently blocked."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-gray-300",children:"IP Address"}),e.jsx("th",{className:"px-4 py-3 text-gray-300",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 text-gray-300",children:"Blocked At"}),e.jsx("th",{className:"px-4 py-3 text-gray-300",children:"Expires At"}),e.jsx("th",{className:"px-4 py-3 text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-white font-mono",children:t.ip_address}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.reason}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.created_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.expires_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>x(t.id,t.ip_address),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded transition-colors",children:"Unblock"})})]},t.id))})]})}),e.jsx("div",{className:"mt-4 text-sm text-gray-400",children:e.jsx("p",{children:"ðŸ’¡ Tip: IPs are automatically unblocked when their expiration time is reached."})})]})}const w=({result:s,onClose:l})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-2xl border border-gray-600 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.type==="scan"?"ðŸ›¡ï¸":s.type==="blacklist"?"ðŸš«":"ðŸ©º",s.title]}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-white",children:"Ã—"})]}),e.jsxs("div",{className:"p-6",children:[s.type==="scan"&&e.jsx("div",{className:"space-y-4",children:s.data.map((a,n)=>e.jsxs("div",{className:"bg-gray-750 p-4 rounded border border-gray-700 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-200",children:a.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:a.detail})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${a.status==="PASS"?"bg-green-900 text-green-300":a.status==="WARNING"?"bg-yellow-900 text-yellow-300":"bg-red-900 text-red-300"}`,children:a.status})]},n))}),s.type==="blacklist"&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:Object.entries(s.data.summary).map(([a,n])=>e.jsxs("div",{className:"bg-gray-900 p-3 rounded text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase",children:a}),e.jsx("div",{className:"font-bold text-white",children:n})]},a))}),e.jsx("h4",{className:"text-sm font-bold text-gray-400 mb-2 uppercase",children:"Recent Blocks"}),e.jsx("div",{className:"space-y-2",children:s.data.recent_blocks.map((a,n)=>e.jsxs("div",{className:"flex justify-between text-sm py-2 border-b border-gray-700 last:border-0",children:[e.jsx("span",{className:"font-mono text-red-400",children:a.ip_address}),e.jsx("span",{className:"text-gray-500",children:a.user_agent?a.user_agent.substring(0,20)+"...":"N/A"}),e.jsx("span",{className:"text-gray-400",children:a.created_at})]},n))})]}),s.type==="health"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.data.map((a,n)=>e.jsxs("div",{className:"bg-gray-750 p-4 rounded border border-gray-700 relative overflow-hidden",children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${a.status==="PASS"?"bg-green-500":a.status==="CRITICAL"?"bg-red-500":a.status==="WARNING"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{className:"ml-2",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase mb-1",children:a.category}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:a.value}),e.jsx("div",{className:"text-xs text-gray-400",children:a.detail})]})]},n))})]}),e.jsx("div",{className:"p-4 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:l,className:"bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded text-white text-sm",children:"Close Report"})})]})}),S=()=>{const[s,l]=d.useState(!1),[a,n]=d.useState(null),c=async r=>{l(!0),n(null);let i="",x="GET";r==="scan"?(i="/api/security/quick-scan",x="POST"):r==="blacklist"?i="/api/security/check-blacklist":r==="health"&&(i="/api/security/system-health");try{const t=await fetch(i,{method:x});if(!t.ok)throw new Error(`HTTP Error ${t.status}`);const h=await t.json();let m;r==="scan"?m=h.checks||[]:r==="blacklist"?m={summary:{},recent_blocks:[]}:r==="health"&&(m=[{category:"Status",value:h.status||"Unknown",status:"PASS",detail:"System operational"},{category:"Uptime",value:h.uptime||"N/A",status:"PASS",detail:"Service availability"},{category:"CPU",value:h.cpu||"N/A",status:"INFO",detail:"Processor usage"},{category:"Memory",value:h.memory||"N/A",status:"INFO",detail:"RAM utilization"}]),n({type:r,title:r==="scan"?"Security Scan Results":r==="blacklist"?"Blacklist Check":"System Health",data:m,timestamp:new Date().toISOString()})}catch(t){console.error(t),alert(`Action Failed: ${t instanceof Error?t.message:"Unknown Error"}`)}finally{l(!1)}};return e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg border border-gray-700 mb-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-400",children:"âš¡"})," Action Center"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>c("scan"),disabled:s,className:`p-4 rounded-lg border flex flex-col items-center justify-center transition
                        ${s?"bg-purple-900 border-purple-700 cursor-wait":"bg-gray-750 hover:bg-gray-700 border-gray-600"}
                    `,children:[e.jsx("span",{className:"text-2xl mb-2",children:"ðŸ›¡ï¸"}),e.jsx("span",{className:"font-bold text-white",children:s?"Running...":"Quick Security Scan"}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:"Malware & Vulnerabilities"})]}),e.jsxs("button",{onClick:()=>c("blacklist"),disabled:s,className:"p-4 rounded-lg bg-gray-750 hover:bg-gray-700 border border-gray-600 flex flex-col items-center justify-center transition",children:[e.jsx("span",{className:"text-2xl mb-2",children:"ðŸš«"}),e.jsx("span",{className:"font-bold text-white",children:"Check Blacklist"}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:"Domain & IP Status"})]}),e.jsxs("button",{onClick:()=>c("health"),disabled:s,className:"p-4 rounded-lg bg-gray-750 hover:bg-gray-700 border border-gray-600 flex flex-col items-center justify-center transition",children:[e.jsx("span",{className:"text-2xl mb-2",children:"ðŸ©º"}),e.jsx("span",{className:"font-bold text-white",children:"System Health"}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:"Performance & Uptime"})]})]}),a&&e.jsx(w,{result:a,onClose:()=>n(null)})]})},k=({data:s})=>{if(!s||s.length===0)return e.jsx("div",{className:"text-gray-500 h-64 flex items-center justify-center",children:"No Traffic Data"});const l=s.map(r=>r.time_slot),a=s.map(r=>parseInt(r.blocked)),n=s.map(r=>parseInt(r.allowed)),c={backgroundColor:"transparent",tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["Allowed Requests","Blocked Threats"],textStyle:{color:"#ccc"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:l,axisLine:{lineStyle:{color:"#555"}},axisLabel:{color:"#aaa"}},yAxis:{type:"value",splitLine:{lineStyle:{color:"#333"}},axisLine:{lineStyle:{color:"#555"}},axisLabel:{color:"#aaa"}},series:[{name:"Allowed Requests",type:"line",smooth:!0,showSymbol:!1,lineStyle:{width:2,color:"#3b82f6"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(59, 130, 246, 0.5)"},{offset:1,color:"rgba(59, 130, 246, 0.1)"}]}},data:n},{name:"Blocked Threats",type:"line",smooth:!0,showSymbol:!1,lineStyle:{width:2,color:"#ef4444"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(239, 68, 68, 0.5)"},{offset:1,color:"rgba(239, 68, 68, 0.1)"}]}},data:a}]};return e.jsx(b,{option:c,style:{height:"300px",width:"100%"}})},_=({data:s})=>{const l=s&&s.length>0?s:[{ip:"192.168.1.5",count:45},{ip:"10.0.0.3",count:32},{ip:"172.16.0.1",count:28},{ip:"BotNet-X",count:15},{ip:"Scanner-Y",count:12}],a={backgroundColor:"transparent",color:["#ef4444"],title:{text:"Threat Radar",textStyle:{color:"#fff",fontSize:14},left:"center",top:10},tooltip:{},radar:{indicator:l.map(n=>({name:n.ip_address||n.ip,max:100})),shape:"circle",splitNumber:5,axisName:{color:"#ef4444"},splitLine:{lineStyle:{color:["rgba(239, 68, 68, 0.1)","rgba(239, 68, 68, 0.2)","rgba(239, 68, 68, 0.4)","rgba(239, 68, 68, 0.6)","rgba(239, 68, 68, 0.8)","rgba(239, 68, 68, 1)"].reverse()}},splitArea:{show:!1},axisLine:{lineStyle:{color:"rgba(239, 68, 68, 0.5)"}}},series:[{name:"Threat Intensity",type:"radar",lineStyle:{width:1,opacity:.5},data:[{value:l.map(n=>n.count),name:"Threat Count",symbol:"none",itemStyle:{color:"#f87171"},areaStyle:{opacity:.3}}]}]};return e.jsx(b,{option:a,style:{height:"300px",width:"100%"}})},A=()=>{const[s,l]=d.useState(null),[a,n]=d.useState(!0),c=async()=>{try{const i=await(await fetch("/api/security/public-activity")).json();l(i),n(!1)}catch(r){console.error("Failed to load public activity",r),n(!1)}};return d.useEffect(()=>{c();const r=setInterval(c,5e3);return()=>clearInterval(r)},[]),a?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading Audience Analytics..."}):s?e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 shadow-lg mb-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"text-cyan-400",children:"ðŸŒ"})," Public User Activity",e.jsx("span",{className:"text-xs bg-cyan-900 text-cyan-200 px-2 py-1 rounded ml-2",children:"Jarik Lurik Landing Page"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-cyan-900/50 to-blue-900/50 p-4 rounded-lg border border-cyan-800 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-cyan-300 text-sm uppercase font-bold tracking-wider",children:"Live Visitors"}),e.jsx("p",{className:"text-xs text-cyan-500",children:"Last 15 Minutes"})]}),e.jsx("div",{className:"text-4xl font-mono text-white font-bold",children:s.active_visitors})]}),e.jsxs("div",{className:"bg-gray-750 p-4 rounded-lg border border-gray-600 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm uppercase font-bold tracking-wider",children:"Page Views"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Today (Since Midnight)"})]}),e.jsx("div",{className:"text-4xl font-mono text-white font-bold",children:s.today_views})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase mb-3 border-b border-gray-700 pb-2",children:"Most Visited Content"}),e.jsxs("div",{className:"space-y-2",children:[s.popular_pages?.map((r,i)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-900/50 p-3 rounded hover:bg-gray-700/50 transition",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsxs("span",{className:"text-gray-500 font-mono text-xs",children:["#",i+1]}),e.jsx("span",{className:"text-cyan-400 text-sm truncate font-medium",title:r.page_url,children:r.page_url||"/"})]}),e.jsxs("span",{className:"text-white font-bold bg-gray-700 px-2 py-1 rounded text-xs",children:[r.views," hits"]})]},i)),(!s.popular_pages||s.popular_pages.length===0)&&e.jsx("div",{className:"text-gray-500 italic text-sm",children:"No page views recorded today."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase mb-3 border-b border-gray-700 pb-2",children:"Real-time Feed"}),e.jsxs("div",{className:"space-y-2 h-[200px] overflow-y-auto custom-scrollbar pr-2",children:[s.recent_activity?.map((r,i)=>e.jsxs("div",{className:"text-xs border-l-2 border-cyan-800 pl-3 py-1 hover:border-cyan-500 transition",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-300 font-mono",children:r.ip_address}),e.jsx("span",{className:"text-gray-500",children:new Date(r.last_activity).toLocaleTimeString()})]}),e.jsx("div",{className:"text-cyan-500 font-medium truncate mb-1",children:r.page_url}),e.jsx("div",{className:"text-gray-600 truncate",title:r.user_agent,children:r.user_agent})]},i)),(!s.recent_activity||s.recent_activity.length===0)&&e.jsx("div",{className:"text-gray-500 italic text-sm",children:"No recent activity."})]})]})]})]}):null};function I(){const[s,l]=d.useState(null),[a,n]=d.useState(!0);return d.useEffect(()=>{const c=async()=>{try{const x=await(await fetch("/api/security/stats")).json();l(x),n(!1)}catch(i){console.error("Error fetching stats:",i)}};c();const r=setInterval(c,5e3);return()=>clearInterval(r)},[]),a?e.jsx("div",{className:"text-white p-10",children:"Loading Security Dashboard..."}):e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:[e.jsxs("header",{className:"mb-8 border-b border-gray-700 pb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-red-500",children:"ðŸ›¡ï¸ BP3MI Security Command Center"}),e.jsx("p",{className:"text-gray-400",children:"Real-time Threat Monitoring & Defense System"})]}),e.jsx(S,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 shadow-lg",children:[e.jsx("h3",{className:"text-gray-400 text-sm uppercase",children:"Total Requests (24h)"}),e.jsx("p",{className:"text-4xl font-bold text-blue-400 mt-2",children:s?.total_requests_24h})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 bg-red-600 text-xs font-bold rounded-bl-lg",children:"LIVE"}),e.jsx("h3",{className:"text-gray-400 text-sm uppercase",children:"Blocked Attacks"}),e.jsx("p",{className:"text-4xl font-bold text-red-500 mt-2",children:s?.blocked_requests_24h})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 shadow-lg",children:[e.jsx("h3",{className:"text-gray-400 text-sm uppercase",children:"System Status"}),e.jsx("p",{className:"text-2xl font-bold text-green-400 mt-2",children:"ACTIVE"})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 shadow-lg",children:[e.jsx("h3",{className:"text-gray-400 text-sm uppercase",children:"Threat Level"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400 mt-2",children:"MODERATE"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-800 p-6 rounded-lg border border-gray-700",children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400",children:"ðŸ“Š"})," Traffic Analysis (24h)"]}),e.jsx(k,{data:s?.traffic_over_time||[]})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700",children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-red-400",children:"ðŸŽ¯"})," Threat Vector Radar"]}),e.jsx(_,{data:s?.top_attackers||[]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-red-400",children:"ðŸš¨ Recent Incidents"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[e.jsx("thead",{className:"bg-gray-900 text-gray-200 uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Time"}),e.jsx("th",{className:"px-4 py-3",children:"Type"}),e.jsx("th",{className:"px-4 py-3",children:"Severity"}),e.jsx("th",{className:"px-4 py-3",children:"Details"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[s?.recent_incidents?.map(c=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3",children:c.created_at}),e.jsx("td",{className:"px-4 py-3 font-medium text-white",children:c.type}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold
                        ${c.severity==="high"?"bg-red-900 text-red-200":c.severity==="medium"?"bg-yellow-900 text-yellow-200":"bg-gray-700"}`,children:c.severity})}),e.jsx("td",{className:"px-4 py-3 truncate max-w-xs",children:c.details})]},c.id)),(!s?.recent_incidents||s.recent_incidents.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-gray-500",children:"No recent incidents detected."})})]})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-400",children:"ðŸŒ Top Sources"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[e.jsx("thead",{className:"bg-gray-900 text-gray-200 uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"IP Address"}),e.jsx("th",{className:"px-4 py-3",children:"Attempts"}),e.jsx("th",{className:"px-4 py-3",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[s?.top_attackers?.map((c,r)=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-white",children:c.ip_address}),e.jsx("td",{className:"px-4 py-3",children:c.count}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{className:"text-red-400 hover:text-red-300 text-xs uppercase font-bold tracking-wider",children:"Block IP"})})]},r)),(!s?.top_attackers||s.top_attackers.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-3 text-center text-gray-500",children:"No attacker data available."})})]})]})})]})]}),e.jsx(f,{}),e.jsx("div",{className:"mt-8",children:e.jsx(v,{})}),e.jsx("div",{className:"mt-8 border-t border-gray-700 pt-8",children:e.jsx(A,{})})]})}y.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(I,{})}));
